# Girl's Frontline Helper

少女前线 Steam 版自动化脚本

---

## 🧾 版本信息

- **2025.08.02**: v1.0.6
    - 实现:“拉弗伯雷兵棋”开房间挂机 （由 @moonight1199 编写）
    - 修复少量bug

- **2025.08.01**: v1.0.5
    - 实现:“虚子粒对-真空湮灭ex” 自动打捞
        - 可以选择需要打捞的人形,如果不选择则默认打捞TKB-408,参数设置见执行脚本中的 `main()` 函数
    - 添加功能:通过脚本直接打开游戏,根据Steam的游戏url(AppID)打开少女前线:"steam://rungameid/3347970"
        - window_ops也封装了关闭应用的函数,如有需要可自行调用,实现全自动

- **2025.07.22**: v1.0.4
    - 实现:“9-4 夜战 斯捷奇金专属(APS专用枪托) ” 自动打捞
    - 修复了一些bug

- **2025.07.21**: v1.0.3
    - 实现:“裂变链接 - 认知裂变1 战斗EX (跑步机)” 自动执行
    - 实现:“13-4 双vector拖尸” 自动执行 （由 @moonight1199 编写）
    - 修复了一些bug

- **2025.07.20**: v1.0.2
    - 代码优化:重构操作逻辑的代码(放着不管迟早要变成屎山
    - 修复了一些bug

- **2025.07.18**: v1.0.1
    - 实现 “裂变链接 - 底层归乡2 战斗EX” 自动打捞 (MP41)

- **2025.07.16**: v1.0.0 初始版本
    - 实现 “溯源回归” 自动打捞
    - 实现 “灰域调查” 自动任务执行功能

---

## 🛠️ 功能介绍

### ✅ 已实现功能

* [x] **“虚子粒对 - 真空湮灭ex”** 自动打捞
* [x] **“灰域调查 - 计划模式”** 自动执行
* [x] **“裂变链接 - 底层归乡2 战斗EX ”** 自动打捞 (MP41)
* [x] **“裂变链接 - 认知裂变1 战斗EX (跑步机)”** 自动执行
* [x] **“13-4 双vector拖尸”** 自动执行
* [x] **“9-4 夜战 ”** 自动打捞 (斯捷奇金专属枪托)
* [x] **“溯源回归 - 行星环ex”** 自动打捞 (活动已结束)
* [x] **“拉弗伯雷兵棋”** 开房间挂机
* [ ] **资源管家**（新建文件夹）📁

### 🚨 异常处理能力

可自动识别并处理以下常见意外窗口并返回主菜单：

- 仓库已满 → 自动操作人形、装备回收
- 主界面检测重创 → 自动一键修理
- 后勤完成提示 → 重新执行
- 成就解锁提示 → 自动关闭
- “灰域调查”模式下各种异常情况

### 📌 使用注意事项

- **关闭 “自动补给” 功能**：设置方法：游戏设置 → 作战 → **关闭**“自动补给”。
- **关闭 “二次确认” 功能**：设置方法：游戏设置 → 作战 → **关闭**“回合结束二次确认”。
- **使游戏处于主菜单页面**：运行脚本前需要让游戏在主菜单页面，所有的操作都从主菜单开始
- **“虚子粒对” 打捞**：把主力队放在第一梯队。未做人形重创处理，若队伍被重创将导致打捞失败，请选择效能足够的一队。
- **“灰域调查” 执行**：资源消耗模式为“探查许可证 + 资源”，若许可证不足将大量消耗资源。
- **“裂变链接” 打捞**：把主力队放在第一梯队，狗粮队放在第二梯队。
- **“裂变链接” 跑步机**：把要练级的队伍放在一,二,三梯队。同时确保确保好友支援里有白包子。
- **“13-4 双vector拖尸”**：事先锁定不想回收的人型，该脚本会自动拆解3/4星的人型。
- **“9-4 夜战”**：需要 "无伤清三红雷" 跟 "打法官无重创" 的队伍。

---

## 📖 使用说明

1. 本项目需在 **125% 缩放比例** 下运行，分辨率 **1920x1080**，游戏设置为 **窗口化 + 分辨率1600x900**
    - 设置方法：
        - 系统缩放：桌面右键 → 显示设置 → 缩放与布局 → 125%
        - 系统分辨率：桌面右键 → 显示设置 → 分辨率 → 1920x1080
            - 屏幕分辨率可以不用设置成 1920x1080,只要确保缩放是125%(但如果运行脚本时出现问题，建议还是设置成 1920x1080)
        - 游戏分辨率：游戏设置 → 分辨率 → 1600x900
        - 游戏显示模式：游戏设置 → 显示模式 → 选择“窗口化”

2. 请确保项目路径中不包含中文或特殊字符
3. 建议以 **管理员权限运行**（不是必须，只要不报错）
4. 执行脚本位于 `game_scripts/` 文件夹内，参数设置见执行脚本中的 `main()` 函数
5. 使用该程序时尽力关闭含"少女前线"字样的其他程序，避免干扰窗口识别:如带有"少女前线"字样的的网页,QQ群聊等

---

# 鼠标图像识别与控制工具

本项目是一个基于图像识别的鼠标控制工具，结合 `pyautogui` 与 `win32api` 实现更加精确和人性化的鼠标操作，适用于自动化测试、游戏脚本、图像点击器等场景。

---

## ✨ 功能特色

- ✅ 基于图像识别的鼠标定位与点击（支持中心/随机点击）
- ✅ 精确模拟真实用户鼠标操作（贝塞尔曲线平滑移动 + 微抖动）
- ✅ 支持等待图像出现、识别后点击/移动等复合行为
- ✅ 控制参数高度可配置：延迟时间、偏移量、相似度等

---

## 🧰 依赖库

详情见 requirements.txt文件，安装方法：

```bash
pip install -r requirements.txt
```

---

## 📁 文件结构与功能说明

**文件结构**

| 路径 / 模块         | 功能简介            |
|-----------------|-----------------|
| `assets/`       | 存放图像识别所需的模板图片   |
| └── `common/`   | 通用图像资源          |
| `config/`       | 配置文件            |
| `core_ops/`     | 鼠标控制与图像识别的核心模块  |
| `game_ops/`     | 封装各类游戏内常用的操作    |
| `game_scripts/` | 游戏脚本目录，对应各个功能模块 |
| ├── `battle/`   | 战斗相关的脚本         |
| └── `manage/`   | 资源管理相关的脚本(还没实现) |

**核心模块功能**

| 模块        | 功能简介                                                                      |
|-----------|---------------------------------------------------------------------------|
| 鼠标操作函数    | `move_to()`、`one_left_click()`、`scroll_mouse()` 等基本鼠标操作封装                 |
| 图像识别函数    | `locate_image()`、`locate_random_point_in_image()` 支持静态图像定位                |
| 图像识别+鼠标动作 | `wait_image()`、`find_image()`、`hold_click_until_image()` 等综合操作            |
| 鼠标平滑移动    | `move_mouse_smoothly()` 支持贝塞尔曲线模拟移动轨迹，带抖动与可视化                             |
| 窗口操作函数    | `close_window()` `activate_window()`  `move_to_window_center()` 等基本窗口操作封装 |
| 应用程序控制    | `open_application_by_url()` 使用URL协议打开应用                                   |

---

## 📷 鼠标轨迹可视化

开启 `move_mouse_smoothly(..., plot=True)` 参数可调试轨迹路径，查看模拟鼠标行为：
> 贝塞尔曲线模拟移动轨迹，到终点偏移后回正，并且模拟人手的微抖动

![轨迹示意图](https://github.com/user-attachments/assets/fd340e55-45c7-42fe-92c9-d909161d5223)

---

## 🙏 鸣谢
 
特别感谢以下贡献者：
 
*   **[@moonight1199](https://github.com/moonight1199)**
 
感谢他们的辛勤付出，完善了这个项目！

---

## 📜 授权协议

本项目遵循 MIT 开源协议，欢迎修改与分发，仅供学习与自动化测试使用，禁止用于恶意自动化行为。
